# Система управления документооборотом "Кызыл Жар"

Веб-приложение для автоматизации документооборота в компании "Кызыл Жар", специализирующейся на управлении недвижимостью и сдаче в аренду.

## Функциональность

- ✅ **Генератор договоров** - автоматическое создание договоров аренды
- ✅ **Трекер сроков** - контроль истечения договоров и документов  
- ✅ **Электронный архив** - хранение и поиск документов
- ⏳ **Система подписей** - управление процессом подписания
- ✅ **Напоминания и уведомления** - автоматические уведомления о важных датах

## Технологический стек

- **Frontend**: React 18, Ant Design, Axios
- **Backend**: Python FastAPI, SQLAlchemy
- **Database**: PostgreSQL 15
- **Containerization**: Docker, Docker Compose
- **Version Control**: Git

## Установка и запуск

### Предварительные требования

- Docker и Docker Compose
- Git

### Быстрый старт

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd document-management-system
```

2. Создайте файл .env в директории backend:
```bash
cd backend
cp .env.example .env
# Отредактируйте .env файл с вашими настройками
```

3. Запустите приложение:
```bash
docker-compose up -d
```

4. Приложение будет доступно по адресам:
   - Frontend: http://localhost:3000
   - Backend API: http://localhost:8000
   - API Documentation: http://localhost:8000/docs

### Разработка

Для разработки можно запускать сервисы по отдельности:

1. Запустите только базу данных:
```bash
docker-compose up -d db
```

2. Запустите backend локально:
```bash
cd backend
pip install -r requirements.txt
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

3. Запустите frontend локально:
```bash
cd frontend
npm install
npm start
```

## API Документация

После запуска backend, автоматически сгенерированная документация API доступна по адресу:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

### Основные эндпоинты

#### Аутентификация
- `POST /api/auth/register` - Регистрация пользователя
- `POST /api/auth/token` - Получение токена доступа
- `GET /api/auth/me` - Получение информации о текущем пользователе

#### Договоры
- `GET /api/contracts/` - Список договоров
- `POST /api/contracts/` - Создание нового договора
- `GET /api/contracts/{contract_id}` - Получение договора по ID
- `PUT /api/contracts/{contract_id}` - Обновление договора
- `DELETE /api/contracts/{contract_id}` - Удаление договора
- `GET /api/contracts/{contract_id}/download` - Скачивание PDF договора

#### Документы
- `POST /api/documents/upload` - Загрузка документа
- `GET /api/documents/` - Список документов
- `GET /api/documents/{document_id}` - Получение документа по ID
- `PUT /api/documents/{document_id}` - Обновление метаданных документа
- `DELETE /api/documents/{document_id}` - Удаление документа
- `GET /api/documents/{document_id}/download` - Скачивание документа

#### Уведомления
- `GET /api/notifications/` - Список уведомлений
- `POST /api/notifications/` - Создание уведомления
- `PUT /api/notifications/{notification_id}` - Обновление уведомления
- `PUT /api/notifications/mark-all-read` - Отметить все как прочитанные
- `DELETE /api/notifications/{notification_id}` - Удаление уведомления

## Структура проекта

```
document-management-system/
├── docker-compose.yml          # Конфигурация Docker Compose
├── nginx.conf                  # Конфигурация Nginx
├── README.md                   # Документация
├── .gitignore                 # Игнорируемые файлы Git
├── backend/                   # Backend приложение
│   ├── Dockerfile            # Docker образ для backend
│   ├── requirements.txt      # Python зависимости
│   ├── main.py              # Главный файл приложения
│   ├── init.sql             # Инициализация базы данных
│   ├── .env                 # Переменные окружения
│   ├── models/              # Модели данных
│   │   ├── __init__.py
│   │   ├── user.py          # Модель пользователя
│   │   ├── contract.py      # Модель договора
│   │   ├── document.py      # Модель документа
│   │   └── notification.py  # Модель уведомления
│   ├── routes/              # API маршруты
│   │   ├── __init__.py
│   │   ├── auth.py          # Аутентификация
│   │   ├── contracts.py     # Управление договорами
│   │   ├── documents.py     # Управление документами
│   │   └── notifications.py # Управление уведомлениями
│   ├── services/            # Бизнес-логика
│   │   ├── __init__.py
│   │   ├── contract_generator.py    # Генерация договоров
│   │   ├── notification_service.py  # Сервис уведомлений
│   │   └── document_service.py      # Сервис документов
│   └── uploads/             # Загруженные файлы
└── frontend/                # Frontend приложение (будет создан отдельно)
    └── ...
```

## Основные возможности системы

### 1. Управление договорами аренды
- Создание договоров с автоматической генерацией номера
- Автоматическое создание PDF документов договоров
- Отслеживание статусов договоров (черновик, активный, завершенный)
- Поиск и фильтрация договоров

### 2. Управление документами
- Загрузка файлов различных форматов
- Привязка документов к договорам
- Система тегов для категоризации
- Полнотекстовый поиск по названию и описанию
- Контроль сроков действия документов

### 3. Система уведомлений
- Автоматические напоминания о истечении договоров
- Уведомления о истечении сроков действия документов
- Напоминания об оплате аренды
- Возможность создания пользовательских уведомлений

### 4. Безопасность
- Аутентификация по JWT токенам
- Хеширование паролей с использованием bcrypt
- Разграничение доступа по ролям
- Защищенные API эндпоинты

## Настройка переменных окружения

Создайте файл `.env` в директории `backend/` со следующими переменными:

```env
# База данных
DATABASE_URL=postgresql://user:password@db:5432/document_management

# Безопасность
SECRET_KEY=your-super-secret-key-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Дополнительные настройки
DEBUG=False
ALLOWED_HOSTS=localhost,127.0.0.1
```

## Миграции базы данных

При первом запуске схема базы данных создается автоматически из файла `init.sql`. 

Для производственной среды рекомендуется использовать Alembic для управления миграциями:

```bash
# Инициализация Alembic (выполнить один раз)
alembic init alembic

# Создание миграции
alembic revision --autogenerate -m "Initial migration"

# Применение миграций
alembic upgrade head
```

## Мониторинг и логирование

Система включает:
- Логирование всех API запросов
- Мониторинг состояния приложения через эндпоинт `/health`
- Автоматическое создание уведомлений о важных событиях

## Производственное развертывание

Для развертывания в производственной среде:

1. Измените переменные окружения на безопасные значения
2. Настройте SSL сертификаты для HTTPS
3. Используйте внешнюю базу данных PostgreSQL
4. Настройте резервное копирование данных
5. Используйте системы мониторинга (Prometheus, Grafana)

## Поддержка и разработка

### Требования к коду
- Следование PEP 8 для Python кода
- Покрытие тестами критически важных функций
- Документирование новых API эндпоинтов
- Использование типизации (Type Hints) в Python

### Внесение изменений
1. Создайте новую ветку для фичи
2. Внесите изменения с соответствующими тестами
3. Обновите документацию при необходимости
4. Создайте Pull Request с описанием изменений

## Лицензия

Этот проект создан для компании "Кызыл Жар" и предназначен для внутреннего использования.

## Контакты

По вопросам разработки и поддержки обращайтесь к команде разработки.

---